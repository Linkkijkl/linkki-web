{{ $startLevel := .Get "start" | default 1 }}
{{ $endLevel := .Get "end" | default 1 }}
{{ $ordered := .Get "ordered" | default true }}
{{ $toc := page.Fragments.ToHTML $startLevel $endLevel $ordered }}

<!-- If you're debugging missing "shy" from heading text, the next line is probably your culprit :) -->
{{ strings.Replace $toc "shy" "" | safeHTML }}